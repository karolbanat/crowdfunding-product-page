"use strict";var skipLink=document.querySelector("#skip-link"),toggleBtn=document.querySelector(".toggle-button"),primaryNav=document.querySelector("#primary-nav"),bookmarkButton=document.querySelector(".bookmark-button"),totalAmountBacked=document.querySelector("#total-amount-backed"),totalBackers=document.querySelector("#total-backers"),progressBar=document.querySelector("#progress-bar"),pledgeButtons=document.querySelectorAll("button[data-reward]"),selectionModal=document.querySelector(".selection-modal"),closeSelectionModalButton=selectionModal.querySelector(".selection-modal__close-button"),selectionButtons=selectionModal.querySelectorAll('input[type="radio"][name="reward"]'),pledgeForms=selectionModal.querySelectorAll(".pledge-form"),successModal=document.querySelector(".success-modal"),successModalCloseButton=successModal.querySelector(".success-modal__confirmation-button"),TOTAL_AMOUNT=1e5,PROGRESS_DATA={amountBacked:89914,backers:5007},DATA_STATES={expanded:"data-expanded",bookmarked:"data-bookmarked",open:"data-open",selected:"data-selected"},handleToggleBtn=function(){toggleBtn.toggleAttribute(DATA_STATES.expanded);var e=toggleBtn.hasAttribute(DATA_STATES.expanded);primaryNav.toggleAttribute(DATA_STATES.expanded,e),toggleBtn.setAttribute("aria-expanded",e)},handleBookmarkButton=function(){bookmarkButton.toggleAttribute(DATA_STATES.bookmarked),saveBookmarkData()},saveBookmarkData=function(){var e=bookmarkButton.hasAttribute(DATA_STATES.bookmarked);localStorage.setItem("bookmarked",JSON.stringify(e))},loadBookmarkData=function(){var e=JSON.parse(localStorage.getItem("bookmarked"));bookmarkButton.toggleAttribute(DATA_STATES.bookmarked,e)},handlePledgeButton=function(e){openSelectionModal();e=e.target.dataset.reward;selectChosenPledge(e)},openSelectionModal=function(){selectionModal.setAttribute(DATA_STATES.open,!0),document.body.classList.add("backdrop")},selectChosenPledge=function(e){e='input[name="reward"][data-reward="'.concat(e,'"'),e=selectionModal.querySelector(e);e&&(unselectAllCards(),e.checked=!0,e.focus(),selectParentCard(e))},closeSelectionModal=function(){selectionModal.removeAttribute(DATA_STATES.open),skipLink.focus(),document.body.classList.remove("backdrop")},handlePledgeSelection=function(e){unselectAllCards(),selectParentCard(e.target)},unselectAllCards=function(){selectionButtons.forEach(function(e){return e.closest(".modal-pledge-card").removeAttribute(DATA_STATES.selected)})},selectParentCard=function(e){e=e.closest(".modal-pledge-card");e&&e.setAttribute(DATA_STATES.selected,!0)},handleFormSubmit=function(e){e.preventDefault();e=e.target.querySelector('input[type="number"]').value;updateProgressData(parseInt(e)),closeSelectionModal(),openSuccessModal()},updateProgressData=function(e){PROGRESS_DATA.amountBacked+=e,PROGRESS_DATA.backers+=1,saveProgressData(),updateProgressBar(),insertProgressData()},saveProgressData=function(){localStorage.setItem("progress",JSON.stringify(PROGRESS_DATA))},loadProgressData=function(){var e,t=JSON.parse(localStorage.getItem("progress"));t&&(e=t.amountBacked,t=t.backers,PROGRESS_DATA.amountBacked=e,PROGRESS_DATA.backers=t),insertProgressData()},insertProgressData=function(){totalAmountBacked.innerText=formatAmount(PROGRESS_DATA.amountBacked),totalBackers.innerText=PROGRESS_DATA.backers.toLocaleString("en-US"),updateProgressBar()},updateProgressBar=function(){var e=(PROGRESS_DATA.amountBacked/TOTAL_AMOUNT*100).toFixed(2);progressBar.style.setProperty("--progress","".concat(e,"%"))},formatAmount=function(e){return"$".concat(e.toLocaleString("en-US"))},openSuccessModal=function(){successModal.setAttribute(DATA_STATES.open,!0),successModalCloseButton.focus(),document.body.classList.add("backdrop")},closeSuccessModal=function(){successModal.removeAttribute(DATA_STATES.open),skipLink.focus(),document.body.classList.remove("backdrop")};toggleBtn.addEventListener("click",handleToggleBtn),bookmarkButton.addEventListener("click",handleBookmarkButton),pledgeButtons.forEach(function(e){e.addEventListener("click",handlePledgeButton)}),closeSelectionModalButton.addEventListener("click",closeSelectionModal),selectionButtons.forEach(function(e){e.addEventListener("change",handlePledgeSelection)}),pledgeForms.forEach(function(e){e.addEventListener("submit",handleFormSubmit)}),successModalCloseButton.addEventListener("click",closeSuccessModal),loadBookmarkData(),loadProgressData(),insertProgressData();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsic2tpcExpbmsiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwcmltYXJ5TmF2IiwidG90YWxBbW91bnRCYWNrZWQiLCJib29rbWFya0J1dHRvbiIsInByb2dyZXNzQmFyIiwiY2xvc2VTZWxlY3Rpb25Nb2RhbEJ1dHRvbiIsInNlbGVjdGlvbk1vZGFsIiwicGxlZGdlQnV0dG9ucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwbGVkZ2VGb3JtcyIsInN1Y2Nlc3NNb2RhbENsb3NlQnV0dG9uIiwic3VjY2Vzc01vZGFsIiwic2VsZWN0aW9uQnV0dG9ucyIsIlBST0dSRVNTX0RBVEEiLCJhbW91bnRCYWNrZWQiLCJiYWNrZXJzIiwiREFUQV9TVEFURVMiLCJleHBhbmRlZCIsImJvb2ttYXJrZWQiLCJvcGVuIiwiVE9UQUxfQU1PVU5UIiwic2VsZWN0ZWQiLCJ0b2dnbGVCdG4iLCJ0b2dnbGVBdHRyaWJ1dGUiLCJoYXNBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJoYW5kbGVUb2dnbGVCdG4iLCJzYXZlQm9va21hcmtEYXRhIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwYXJzZSIsImdldEl0ZW0iLCJlIiwib3BlblNlbGVjdGlvbk1vZGFsIiwicmV3YXJkIiwidGFyZ2V0IiwiZGF0YXNldCIsInNlbGVjdENob3NlblBsZWRnZSIsImxvYWRCb29rbWFya0RhdGEiLCJib2R5IiwiY2xhc3NMaXN0IiwiYWRkIiwic2VsZWN0ZWRQbGVkZ2VJbnB1dCIsInF1ZXJ5IiwiZm9jdXMiLCJzZWxlY3RQYXJlbnRDYXJkIiwicmVtb3ZlQXR0cmlidXRlIiwicmVtb3ZlIiwidW5zZWxlY3RBbGxDYXJkcyIsImNsb3NlU2VsZWN0aW9uTW9kYWwiLCJidXR0b24iLCJwYXJlbnQiLCJlbGVtZW50IiwiY2xvc2VzdCIsImhhbmRsZUZvcm1TdWJtaXQiLCJwcmV2ZW50RGVmYXVsdCIsInZhbHVlIiwidXBkYXRlUHJvZ3Jlc3NEYXRhIiwiaW5wdXRWYWx1ZSIsIm9wZW5TdWNjZXNzTW9kYWwiLCJzYXZlUHJvZ3Jlc3NEYXRhIiwidXBkYXRlUHJvZ3Jlc3NCYXIiLCJpbnNlcnRQcm9ncmVzc0RhdGEiLCJmb3JtSW5wdXQiLCJwYXJzZUludCIsImxvYWRQcm9ncmVzc0RhdGEiLCJwcm9ncmVzc0RhdGEiLCJpbm5lclRleHQiLCJmb3JtYXRBbW91bnQiLCJ0b3RhbEJhY2tlcnMiLCJ0b0xvY2FsZVN0cmluZyIsInRvRml4ZWQiLCJzdHlsZSIsInNldFByb3BlcnR5IiwiY29uY2F0IiwicHJvZ3Jlc3MiLCJhZGRFdmVudExpc3RlbmVyIiwiYW1vdW50IiwiZm9yRWFjaCIsImhhbmRsZVBsZWRnZUJ1dHRvbiIsImZvcm0iLCJjbG9zZVN1Y2Nlc3NNb2RhbCJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBTUEsU0FBV0MsU0FBU0MsY0FBYyxZQUF2QixFQUFYRixVQUFXQyxTQUFTQyxjQUFjLGdCQUF2QkQsRUFDakJFLFdBQUFGLFNBQUFDLGNBQUEsY0FBQSxFQUVNQyxlQUFhRixTQUFTQyxjQUFjLGtCQUF2QkQsRUFLYkcsa0JBQW9CSCxTQUFTQyxjQUFjLHNCQUF2QixFQUZwQkcsYUFBaUJKLFNBQVNDLGNBQWMsZ0JBQXZCRCxFQUN2QkssWUFBQUwsU0FBQUMsY0FBQSxlQUFBLEVBQ01FLGNBQWlCSCxTQUFHQSxpQkFBdUIscUJBQTFCLEVBRWpCSyxlQUFjTCxTQUFTQyxjQUFjLGtCQUF2QkQsRUFDcEJNLDBCQUFBQyxlQUFBTixjQUFBLGdDQUFBLEVBQ01PLGlCQUFnQlIsZUFBU1MsaUJBQWlCLG9DQUExQlQsRUFPaEJVLFlBQWNILGVBQWVFLGlCQUFpQixjQUFoQyxFQUpkSCxhQUFBQSxTQUF5QkwsY0FBR00sZ0JBQTVCRCxFQUNOSyx3QkFBQUMsYUFBQVgsY0FBQSxxQ0FBQSxFQUNNWSxhQUFnQixJQUN0QkMsY0FBQSxDQVFDQyxhQUFjLE1BUGZDLFFBQU1OLElBRE4sRUFXTU8sWUFBYyxDQVJwQkMsU0FBTU4sZ0JBQ05PLFdBQU1SLGtCQUVOUyxLQUFNQyxZQUNOQyxTQUFNUixlQUljLEVBQWRHLGdCQUFjLFdBU25CTSxVQVJRQyxnQkFEV1AsWUFBQUMsUUFTbkIsRUFDQSxJQVJBQyxFQUFZSSxVQUFBRSxhQUZPUixZQUFBQyxRQUVQLEVBU1poQixXQVJNc0IsZ0JBSGFQLFlBQUFDLFNBQUFBLENBV25CLEVBQ0FLLFVBUlFHLGFBQUUsZ0JBQUFSLENBUVYsQ0FaRCxFQVFNUyxxQkFBa0IsV0FTdkJ2QixlQVJVb0IsZ0JBQWdCUCxZQUFZQyxVQVF0QyxFQUNBVSxpQkFSaUJMLENBU2pCLEVBWERLLGlCQUFBLFdBT0EsSUFBQVQsRUFBQWYsZUFBQXFCLGFBQUFSLFlBQUFFLFVBQUEsRUFRQ1UsYUFBYUMsUUFBUSxhQUFjQyxLQUFLQyxVQUFVYixDQUFmLENBQW5DLENBQ0EsRUFQQWYsaUJBQWVvQixXQVVmLElBVEFJLEVBQWdCRyxLQUFBRSxNQUFBSixhQUFBSyxRQUFBLFlBQUEsQ0FBQSxFQUZqQjlCLGVBQUFvQixnQkFBQVAsWUFBQUUsV0FBQUEsQ0FBQSxDQWFDLEVBTkFVLG1CQUFxQixTQUFBTSxHQUZ0QkMsbUJBQUEsRUFhT0MsRUFBU0YsRUFBRUcsT0FBT0MsUUFBUUYsT0FSakNHLG1CQUFzQkgsQ0FBaEJJLENBVUwsRUFWREwsbUJBQUEsV0FLQTdCLGVBQUFtQixhQUFBVCxZQUFBRyxLQUFBLENBQUEsQ0FBQSxFQVNDcEIsU0FBUzBDLEtBQUtDLFVBQVVDLElBQUksVUFBNUIsQ0FDQSxFQVJBUixtQkFBa0IsU0FBQUMsR0FFbEJHLEVBQUFBLHFDQUFBQSxPQUFBSCxFQUFBRyxHQUFBQSxFQUhESyxFQUFBdEMsZUFBQU4sY0FBQTZDLENBQUEsRUFNTVYsSUFDTDdCLGlCQUFlbUIsRUFDZjFCLEVBQWMyQyxRQUFjLENBQUEsRUFGN0JFLEVBQUFFLE1BQUEsRUFjRUMsaUJBQWlCSCxDQUFELEVBRWpCLEVBUk1BLG9CQUFzQnRDLFdBVzVCQSxlQVZBMEMsZ0JBQUFoQyxZQUFBRyxJQVVBLEVBQ0FyQixTQUFTZ0QsTUFBVCxFQUNBL0MsU0FYSTZDLEtBQUFBLFVBQUpLLE9BQXlCLFVBV3pCLENBQ0EsRUFUQ0wsc0JBQUEsU0FBQVYsR0FZRGdCLGlCQUFnQixFQUNoQkgsaUJBWkNBLEVBQWdCVixNQUFoQlUsQ0FhRCxFQUVLRyxpQkFBbUIsV0FYekJ0QyxpQkFBTXVDLFFBQXNCLFNBQUFDLEdBQUEsT0FBdEJELEVBQUFBLFFBQUFBLG9CQUFBQSxFQUE0QkgsZ0JBQUFoQyxZQUFBSyxRQUE1QjhCLENBQXNCLENBQTVCLENBYUMsRUFWQXBELGlCQUFBLFNBQXdCa0QsR0FIekJJLEVBQUFDLEVBQUFDLFFBQUEsb0JBQUEsRUFpQktGLEdBQVFBLEVBQU81QixhQUFhVCxZQUFZSyxTQUFVLENBQUEsQ0FBMUMsQ0FYYixFQUFBbUMsaUJBQUEsU0FBQXRCLEdBZ0JDQSxFQUFFdUIsZUFBRixFQVZBN0MsRUFES3NDLEVBQWdCYixPQUFHckMsY0FBbkJrRCxzQkFBQUEsRUFDb0JRLE1BYXpCQyxtQkFiNENKLFNBQVFLLENBQUEsQ0FBUkwsRUFjNUNKLG9CQWRBLEVBRERVLGlCQUFBLENBaUJDLEVBWElSLG1CQUFlNUIsU0FBQUEsR0FGcEJaLGNBQUFDLGNBQUE0QyxFQUtBN0MsY0FBQUUsU0FBQSxFQWNDK0MsaUJBQWdCLEVBQ2hCQyxrQkFBaUIsRUFkbEJDLG1CQUFNUixDQWdCTCxFQWJNSSxpQkFBYUssV0FnQm5CckMsYUFmQStCLFFBQW1CTyxXQUFTTixLQUFBQSxVQUE1Qi9DLGFBQTRCK0MsQ0FlNUIsQ0FDQSxFQXBCRE8saUJBQUEsV0FTQSxJQWdCVXJELEVBaEJWc0QsRUFBQXRDLEtBQUFFLE1BQUFKLGFBQUFLLFFBQUEsVUFBQSxDQUFBLEVBZUttQyxJQUNLdEQsRUFBMEJzRCxFQUExQnRELGFBQWNDLEVBQVlxRCxFQUFackQsUUFmeEJGLGNBQU04QyxhQUFxQjdDLEVBQzFCRCxjQUFjQyxRQUFBQSxHQWtCZGtELG1CQWhCZ0IsQ0FpQmhCLEVBcEJEQSxtQkFBQSxXQXVCQzlELGtCQUFrQm1FLFVBQVlDLGFBQWF6RCxjQUFjQyxZQUFmLEVBZjNDeUQsYUFBTVQsVUFBbUJqRCxjQUFuQmlELFFBQW1CVSxlQUFNLE9BQU4sRUFpQnhCVCxrQkFoQmFsQyxDQURkLEVBSU1zQyxrQkFBbUIsV0FpQnhCLElBaEJNQyxHQUFZdkQsY0FBY2UsYUFBYUssYUFBN0MsS0FBQXdDLFFBQUEsQ0FBa0IsRUFpQmxCckUsWUFBWXNFLE1BQU1DLFlBQVksYUFBOUIsR0FBQUMsT0FBK0NDLEVBQS9DLEdBQUEsQ0FBQSxDQUNBLEVBaEJDUCxhQUFrQ0YsU0FBQUEsR0FtQm5DLE1BQUEsSUFBQVEsT0FsQkMvRCxFQUFjQyxlQUFlQSxPQUE3QkQsQ0FrQkQsQ0FDQSxFQWhCQW1ELGlCQUFrQixXQVBuQnJELGFBQUFjLGFBQUFULFlBQUFHLEtBQUEsQ0FBQSxDQUFBLEVBNEJDVCx3QkFBd0JvQyxNQUF4QixFQWxCRC9DLFNBQU1pRSxLQUFBQSxVQUFxQnJCLElBQUEsVUFBM0IsQ0FvQkMsRUFqQkFvQixrQkFBaUIsV0FIbEJwRCxhQUFBcUMsZ0JBQUFoQyxZQUFBRyxJQUFBLEVBd0JDckIsU0FBU2dELE1BQVQsRUFsQkQvQyxTQUFNZ0UsS0FBQUEsVUFBb0JkLE9BQUEsVUFBMUIsQ0FvQkMsRUFHRDNCLFVBQVV3RCxpQkFBaUIsUUFBU3BELGVBQXBDLEVBbEJBdkIsZUFBTW1FLGlCQUFBQSxRQUFnQlMsb0JBQXRCLEVBb0JBeEUsY0FuQkN5RSxRQUFXRCxTQUFBQSxHQURaM0IsRUFBQTBCLGlCQUFBLFFBQUFHLGtCQUFBLENBSUEsQ0FnQkEsRUFHQTVFLDBCQUEwQnlFLGlCQUFpQixRQUFTM0IsbUJBQXBELEVBQ0F2QyxpQkFBaUJvRSxRQUFRLFNBQUM1QixHQW5CMUJBLEVBQU1TLGlCQUFtQixTQUFuQkEscUJBQU4sQ0FxQkMsQ0FGRCxFQUdBcEQsWUFwQkNDLFFBQUFBLFNBQUFBLEdBcUJBd0UsRUFBS0osaUJBQWlCLFNBQVV0QixnQkFBaEMsQ0FDQSxDQUZELEVBbEJDOUMsd0JBSkRvRSxpQkFBQSxRQUFBSyxpQkFJQyxFQXdCRDNDLGlCQXJCY1EsRUFzQmRtQixpQkFyQkMsRUFzQkRILG1CQUFrQiIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIHNraXAgbGluayAqL1xyXG5jb25zdCBza2lwTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNza2lwLWxpbmsnKTtcclxuLyogbmF2IGVsZW1lbnRzICovXHJcbmNvbnN0IHRvZ2dsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50b2dnbGUtYnV0dG9uJyk7XHJcbmNvbnN0IHByaW1hcnlOYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJpbWFyeS1uYXYnKTtcclxuXHJcbi8qIGJvb2ttYXJrICovXHJcbmNvbnN0IGJvb2ttYXJrQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvb2ttYXJrLWJ1dHRvbicpO1xyXG4vKiBwcm9ncmVzcyAqL1xyXG5jb25zdCB0b3RhbEFtb3VudEJhY2tlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0b3RhbC1hbW91bnQtYmFja2VkJyk7XHJcbmNvbnN0IHRvdGFsQmFja2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0b3RhbC1iYWNrZXJzJyk7XHJcbmNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2dyZXNzLWJhcicpO1xyXG4vKiBwbGVkZ2UgYnV0dG9ucyAtIGJ1dHRvbnMgaW4gYWJvdXQgc2VjdGlvbiBhbmQgaGVhZGVyICovXHJcbmNvbnN0IHBsZWRnZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b25bZGF0YS1yZXdhcmRdJyk7XHJcbi8qIHNlbGVjdGlvbiBtb2RhbCAqL1xyXG5jb25zdCBzZWxlY3Rpb25Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWxlY3Rpb24tbW9kYWwnKTtcclxuY29uc3QgY2xvc2VTZWxlY3Rpb25Nb2RhbEJ1dHRvbiA9IHNlbGVjdGlvbk1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5zZWxlY3Rpb24tbW9kYWxfX2Nsb3NlLWJ1dHRvbicpO1xyXG4vKiBwbGVkZ2Ugc2VsZWN0IHJhZGlvIGJ1dHRvbnMgKi9cclxuY29uc3Qgc2VsZWN0aW9uQnV0dG9ucyA9IHNlbGVjdGlvbk1vZGFsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9XCJyYWRpb1wiXVtuYW1lPVwicmV3YXJkXCJdJyk7XHJcbi8qIGZvcm1zICovXHJcbmNvbnN0IHBsZWRnZUZvcm1zID0gc2VsZWN0aW9uTW9kYWwucXVlcnlTZWxlY3RvckFsbCgnLnBsZWRnZS1mb3JtJyk7XHJcbi8qIHN1Y2Nlc3MgbW9kYWwgKi9cclxuY29uc3Qgc3VjY2Vzc01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN1Y2Nlc3MtbW9kYWwnKTtcclxuY29uc3Qgc3VjY2Vzc01vZGFsQ2xvc2VCdXR0b24gPSBzdWNjZXNzTW9kYWwucXVlcnlTZWxlY3RvcignLnN1Y2Nlc3MtbW9kYWxfX2NvbmZpcm1hdGlvbi1idXR0b24nKTtcclxuXHJcbmNvbnN0IFRPVEFMX0FNT1VOVCA9IDEwMDAwMDtcclxuY29uc3QgUFJPR1JFU1NfREFUQSA9IHtcclxuXHRhbW91bnRCYWNrZWQ6IDg5OTE0LFxyXG5cdGJhY2tlcnM6IDUwMDcsXHJcbn07XHJcbmNvbnN0IERBVEFfU1RBVEVTID0ge1xyXG5cdGV4cGFuZGVkOiAnZGF0YS1leHBhbmRlZCcsXHJcblx0Ym9va21hcmtlZDogJ2RhdGEtYm9va21hcmtlZCcsXHJcblx0b3BlbjogJ2RhdGEtb3BlbicsXHJcblx0c2VsZWN0ZWQ6ICdkYXRhLXNlbGVjdGVkJyxcclxufTtcclxuXHJcbi8qIHRvZ2dsZSBuYXYgYnV0dG9uIGhhbmRsaW5nICovXHJcbmNvbnN0IGhhbmRsZVRvZ2dsZUJ0biA9ICgpID0+IHtcclxuXHR0b2dnbGVCdG4udG9nZ2xlQXR0cmlidXRlKERBVEFfU1RBVEVTLmV4cGFuZGVkKTtcclxuXHRjb25zdCBleHBhbmRlZCA9IHRvZ2dsZUJ0bi5oYXNBdHRyaWJ1dGUoREFUQV9TVEFURVMuZXhwYW5kZWQpO1xyXG5cdHByaW1hcnlOYXYudG9nZ2xlQXR0cmlidXRlKERBVEFfU1RBVEVTLmV4cGFuZGVkLCBleHBhbmRlZCk7XHJcblx0dG9nZ2xlQnRuLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIGV4cGFuZGVkKTtcclxufTtcclxuXHJcbi8qIGJvb2ttYXJrIGhhbmRsaW5nICovXHJcbmNvbnN0IGhhbmRsZUJvb2ttYXJrQnV0dG9uID0gKCkgPT4ge1xyXG5cdGJvb2ttYXJrQnV0dG9uLnRvZ2dsZUF0dHJpYnV0ZShEQVRBX1NUQVRFUy5ib29rbWFya2VkKTtcclxuXHRzYXZlQm9va21hcmtEYXRhKCk7XHJcbn07XHJcblxyXG5jb25zdCBzYXZlQm9va21hcmtEYXRhID0gKCkgPT4ge1xyXG5cdGNvbnN0IGJvb2ttYXJrZWQgPSBib29rbWFya0J1dHRvbi5oYXNBdHRyaWJ1dGUoREFUQV9TVEFURVMuYm9va21hcmtlZCk7XHJcblx0bG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Jvb2ttYXJrZWQnLCBKU09OLnN0cmluZ2lmeShib29rbWFya2VkKSk7XHJcbn07XHJcblxyXG5jb25zdCBsb2FkQm9va21hcmtEYXRhID0gKCkgPT4ge1xyXG5cdGNvbnN0IGJvb2ttYXJrZWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdib29rbWFya2VkJykpO1xyXG5cdGJvb2ttYXJrQnV0dG9uLnRvZ2dsZUF0dHJpYnV0ZShEQVRBX1NUQVRFUy5ib29rbWFya2VkLCBib29rbWFya2VkKTtcclxufTtcclxuXHJcbi8qIHBsZWRnZSBidXR0b24gaGFuZGxpbmcgKi9cclxuY29uc3QgaGFuZGxlUGxlZGdlQnV0dG9uID0gKGUpID0+IHtcclxuXHRvcGVuU2VsZWN0aW9uTW9kYWwoKTtcclxuXHRjb25zdCByZXdhcmQgPSBlLnRhcmdldC5kYXRhc2V0LnJld2FyZDtcclxuXHRzZWxlY3RDaG9zZW5QbGVkZ2UocmV3YXJkKTtcclxufTtcclxuXHJcbmNvbnN0IG9wZW5TZWxlY3Rpb25Nb2RhbCA9ICgpID0+IHtcclxuXHRzZWxlY3Rpb25Nb2RhbC5zZXRBdHRyaWJ1dGUoREFUQV9TVEFURVMub3BlbiwgdHJ1ZSk7XHJcblx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdiYWNrZHJvcCcpO1xyXG59O1xyXG5cclxuY29uc3Qgc2VsZWN0Q2hvc2VuUGxlZGdlID0gKHJld2FyZCkgPT4ge1xyXG5cdC8qIGZpbmQgaW5wdXQgd2l0aCBjaG9zZW4gcmV3YXJkICovXHJcblx0Y29uc3QgcXVlcnkgPSBgaW5wdXRbbmFtZT1cInJld2FyZFwiXVtkYXRhLXJld2FyZD1cIiR7cmV3YXJkfVwiYDtcclxuXHRjb25zdCBzZWxlY3RlZFBsZWRnZUlucHV0ID0gc2VsZWN0aW9uTW9kYWwucXVlcnlTZWxlY3RvcihxdWVyeSk7XHJcblx0LyogaWYgZm91bmQgc2VsZWN0IGl0IGFuZCBwYXJlbnQgY2FyZCAqL1xyXG5cdGlmIChzZWxlY3RlZFBsZWRnZUlucHV0KSB7XHJcblx0XHR1bnNlbGVjdEFsbENhcmRzKCk7XHJcblx0XHRzZWxlY3RlZFBsZWRnZUlucHV0LmNoZWNrZWQgPSB0cnVlO1xyXG5cdFx0c2VsZWN0ZWRQbGVkZ2VJbnB1dC5mb2N1cygpOyAvLyBnaXZlIGZvY3VzIHRvIHNlbGVjdGVkIGlucHV0IGFmdGVyIG9wZW5pbmcgbW9kYWxcclxuXHRcdHNlbGVjdFBhcmVudENhcmQoc2VsZWN0ZWRQbGVkZ2VJbnB1dCk7XHJcblx0fVxyXG59O1xyXG5cclxuY29uc3QgY2xvc2VTZWxlY3Rpb25Nb2RhbCA9ICgpID0+IHtcclxuXHRzZWxlY3Rpb25Nb2RhbC5yZW1vdmVBdHRyaWJ1dGUoREFUQV9TVEFURVMub3Blbik7XHJcblx0c2tpcExpbmsuZm9jdXMoKTtcclxuXHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2JhY2tkcm9wJyk7XHJcbn07XHJcblxyXG5jb25zdCBoYW5kbGVQbGVkZ2VTZWxlY3Rpb24gPSAoZSkgPT4ge1xyXG5cdHVuc2VsZWN0QWxsQ2FyZHMoKTtcclxuXHRzZWxlY3RQYXJlbnRDYXJkKGUudGFyZ2V0KTtcclxufTtcclxuXHJcbmNvbnN0IHVuc2VsZWN0QWxsQ2FyZHMgPSAoKSA9PiB7XHJcblx0c2VsZWN0aW9uQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IGJ1dHRvbi5jbG9zZXN0KCcubW9kYWwtcGxlZGdlLWNhcmQnKS5yZW1vdmVBdHRyaWJ1dGUoREFUQV9TVEFURVMuc2VsZWN0ZWQpKTtcclxufTtcclxuXHJcbmNvbnN0IHNlbGVjdFBhcmVudENhcmQgPSAoZWxlbWVudCkgPT4ge1xyXG5cdGNvbnN0IHBhcmVudCA9IGVsZW1lbnQuY2xvc2VzdCgnLm1vZGFsLXBsZWRnZS1jYXJkJyk7XHJcblx0aWYgKHBhcmVudCkgcGFyZW50LnNldEF0dHJpYnV0ZShEQVRBX1NUQVRFUy5zZWxlY3RlZCwgdHJ1ZSk7XHJcbn07XHJcblxyXG4vKiBmb3JtIHN1Ym1pdHNzaW9uICovXHJcbmNvbnN0IGhhbmRsZUZvcm1TdWJtaXQgPSAoZSkgPT4ge1xyXG5cdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRjb25zdCBmb3JtSW5wdXQgPSBlLnRhcmdldC5xdWVyeVNlbGVjdG9yKCdpbnB1dFt0eXBlPVwibnVtYmVyXCJdJyk7XHJcblx0Y29uc3QgaW5wdXRWYWx1ZSA9IGZvcm1JbnB1dC52YWx1ZTtcclxuXHR1cGRhdGVQcm9ncmVzc0RhdGEocGFyc2VJbnQoaW5wdXRWYWx1ZSkpO1xyXG5cdGNsb3NlU2VsZWN0aW9uTW9kYWwoKTtcclxuXHRvcGVuU3VjY2Vzc01vZGFsKCk7XHJcbn07XHJcblxyXG4vKiBwcm9ncmVzcyBoYW5kbGluZyAqL1xyXG5jb25zdCB1cGRhdGVQcm9ncmVzc0RhdGEgPSAodmFsdWUpID0+IHtcclxuXHRQUk9HUkVTU19EQVRBLmFtb3VudEJhY2tlZCArPSB2YWx1ZTtcclxuXHRQUk9HUkVTU19EQVRBLmJhY2tlcnMgKz0gMTtcclxuXHRzYXZlUHJvZ3Jlc3NEYXRhKCk7XHJcblx0dXBkYXRlUHJvZ3Jlc3NCYXIoKTtcclxuXHRpbnNlcnRQcm9ncmVzc0RhdGEoKTtcclxufTtcclxuXHJcbmNvbnN0IHNhdmVQcm9ncmVzc0RhdGEgPSAoKSA9PiB7XHJcblx0bG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2dyZXNzJywgSlNPTi5zdHJpbmdpZnkoUFJPR1JFU1NfREFUQSkpO1xyXG59O1xyXG5cclxuY29uc3QgbG9hZFByb2dyZXNzRGF0YSA9ICgpID0+IHtcclxuXHRjb25zdCBwcm9ncmVzc0RhdGEgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwcm9ncmVzcycpKTtcclxuXHRpZiAocHJvZ3Jlc3NEYXRhKSB7XHJcblx0XHRjb25zdCB7IGFtb3VudEJhY2tlZCwgYmFja2VycyB9ID0gcHJvZ3Jlc3NEYXRhO1xyXG5cdFx0UFJPR1JFU1NfREFUQS5hbW91bnRCYWNrZWQgPSBhbW91bnRCYWNrZWQ7XHJcblx0XHRQUk9HUkVTU19EQVRBLmJhY2tlcnMgPSBiYWNrZXJzO1xyXG5cdH1cclxuXHRpbnNlcnRQcm9ncmVzc0RhdGEoKTtcclxufTtcclxuXHJcbmNvbnN0IGluc2VydFByb2dyZXNzRGF0YSA9ICgpID0+IHtcclxuXHR0b3RhbEFtb3VudEJhY2tlZC5pbm5lclRleHQgPSBmb3JtYXRBbW91bnQoUFJPR1JFU1NfREFUQS5hbW91bnRCYWNrZWQpO1xyXG5cdHRvdGFsQmFja2Vycy5pbm5lclRleHQgPSBQUk9HUkVTU19EQVRBLmJhY2tlcnMudG9Mb2NhbGVTdHJpbmcoJ2VuLVVTJyk7XHJcblx0dXBkYXRlUHJvZ3Jlc3NCYXIoKTtcclxufTtcclxuXHJcbmNvbnN0IHVwZGF0ZVByb2dyZXNzQmFyID0gKCkgPT4ge1xyXG5cdGNvbnN0IHByb2dyZXNzID0gKChQUk9HUkVTU19EQVRBLmFtb3VudEJhY2tlZCAvIFRPVEFMX0FNT1VOVCkgKiAxMDApLnRvRml4ZWQoMik7XHJcblx0cHJvZ3Jlc3NCYXIuc3R5bGUuc2V0UHJvcGVydHkoJy0tcHJvZ3Jlc3MnLCBgJHtwcm9ncmVzc30lYCk7XHJcbn07XHJcblxyXG5jb25zdCBmb3JtYXRBbW91bnQgPSAoYW1vdW50KSA9PiB7XHJcblx0cmV0dXJuIGAkJHthbW91bnQudG9Mb2NhbGVTdHJpbmcoJ2VuLVVTJyl9YDtcclxufTtcclxuXHJcbi8qIHN1Y2Nlc3MgbW9kYWwgaGFuZGxpbmcgKi9cclxuY29uc3Qgb3BlblN1Y2Nlc3NNb2RhbCA9ICgpID0+IHtcclxuXHRzdWNjZXNzTW9kYWwuc2V0QXR0cmlidXRlKERBVEFfU1RBVEVTLm9wZW4sIHRydWUpO1xyXG5cdHN1Y2Nlc3NNb2RhbENsb3NlQnV0dG9uLmZvY3VzKCk7IC8vIGdpdmUgZm9jdXMgdG8gY29uZmlybWF0aW9uIGJ1dHRvblxyXG5cdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnYmFja2Ryb3AnKTtcclxufTtcclxuXHJcbmNvbnN0IGNsb3NlU3VjY2Vzc01vZGFsID0gKCkgPT4ge1xyXG5cdHN1Y2Nlc3NNb2RhbC5yZW1vdmVBdHRyaWJ1dGUoREFUQV9TVEFURVMub3Blbik7XHJcblx0c2tpcExpbmsuZm9jdXMoKTsgLy8gZ2l2ZSBmb2N1cyB0byBza2lwIGxpbmsgYWZ0ZXIgY2xvc2luZyBzdWNjZXNzIG1vZGFsXHJcblx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdiYWNrZHJvcCcpO1xyXG59O1xyXG5cclxuLyogZXZlbnQgbGlzdGVuZXJzICovXHJcbnRvZ2dsZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVRvZ2dsZUJ0bik7XHJcbmJvb2ttYXJrQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQm9va21hcmtCdXR0b24pO1xyXG5wbGVkZ2VCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xyXG5cdGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVBsZWRnZUJ1dHRvbik7XHJcbn0pO1xyXG5jbG9zZVNlbGVjdGlvbk1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VTZWxlY3Rpb25Nb2RhbCk7XHJcbnNlbGVjdGlvbkJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcblx0YnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGhhbmRsZVBsZWRnZVNlbGVjdGlvbik7XHJcbn0pO1xyXG5wbGVkZ2VGb3Jtcy5mb3JFYWNoKChmb3JtKSA9PiB7XHJcblx0Zm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWl0KTtcclxufSk7XHJcbnN1Y2Nlc3NNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VTdWNjZXNzTW9kYWwpO1xyXG5cclxuLyogaW5pdGlhbCBhY3Rpb25zICovXHJcbmxvYWRCb29rbWFya0RhdGEoKTtcclxubG9hZFByb2dyZXNzRGF0YSgpO1xyXG5pbnNlcnRQcm9ncmVzc0RhdGEoKTtcclxuIl19
